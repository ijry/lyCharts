import{_ as t,c as e,o as a,w as i,a as s,p as n,q as r,i as o,e as h,f as l,b as d,d as c}from"./index-CX9O2B3o.js";import{c as p}from"./chartHelper.WSh08z7V.js";const u=t({name:"u-charts-radar",props:{options:{type:Object,required:!0,default:()=>({})},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:300},theme:{type:Object,default:()=>({})},chartId:{type:String,default:"radarChart"}},data(){return{cid:"u-charts-radar-"+Math.random().toString(36).substr(2),canvasWidth:"string"==typeof this.width&&-1!==this.width.indexOf("%")?null:"number"==typeof this.width?this.width:this.parseUnit(this.width),canvasHeight:"string"==typeof this.height?this.parseUnit(this.height):this.height,chartInstance:null,isMount:!1}},watch:{options:{handler(t){this.isMount&&this.drawChart()},deep:!0}},mounted(){this.isMount=!0,this.$nextTick(()=>{this.init()})},beforeDestroy(){this.chartInstance&&this.chartInstance.destroy()},methods:{init(){this.getCanvasSize().then(()=>{this.drawChart()})},initNvue(){dom.getComponentRect(this.$refs.canvas,t=>{t.result&&(this.canvasWidth=t.size.width,this.canvasHeight=t.size.height,this.drawChart())})},parseUnit:t=>"number"==typeof t?t:"string"==typeof t?t.endsWith("rpx")?uni.upx2px(parseInt(t)):t.endsWith("px")?parseInt(t):t.endsWith("%")?t:parseInt(t)||0:0,getCanvasSize(){return new Promise(t=>{"number"==typeof this.canvasWidth&&this.canvasWidth>0?t():uni.createSelectorQuery().in(this).select("#"+this.cid).boundingClientRect(e=>{e?(this.canvasWidth=e.width||this.width,this.canvasHeight=e.height||this.height):(this.canvasWidth="string"==typeof this.width&&-1!==this.width.indexOf("%")?uni.upx2px(750)*parseInt(this.width)/100:this.parseUnit(this.width),this.canvasHeight=this.parseUnit(this.height)),t()}).exec()})},drawChart(){this.options&&Object.keys(this.options).length&&this.drawNativeRadar()},drawNativeRadar(){const t=uni.createCanvasContext(this.cid,this);t.clearRect(0,0,this.canvasWidth,this.canvasHeight);const e=this.options.radar||{},a=(this.options.series||[]).map(t=>Array.isArray(t)?{data:t}:t);if(!e.indicator||!e.indicator.length||!a.length)return;let i=0,s=0;this.options.title&&!1!==this.options.title.show&&(s=this.drawChartTitle(t),i+=s);let n=0,r=0,o=0,h=0;if(this.options.legend&&!1!==this.options.legend.show){const e=this.drawChartLegend(t,i,s);n=e.height,e.width,r=e.left,o=e.right,null!=this.options.legend.top?i+=n:h=n-i/2}const l=e.indicator;l.length;const d=r+(this.canvasWidth-o-r)/2,c=i+(this.canvasHeight-i-h)/2,p=.37*Math.min(this.canvasWidth-r-o,this.canvasHeight-i-h);this.drawRadarGrid(t,d,c,p,l),this.drawRadarData(t,d,c,p,l,a),this.drawRadarLabels(t,d,c,p,l),t.draw(!1),this.chartInstance={type:"native-radar",data:a,indicators:l,centerX:d,centerY:c,radius:p,destroy:()=>{}}},drawChartTitle(t){var e,a,i,s;const n=this.options.title;if(!n||!1===n.show)return 0;let r=0;if(n.text){const i=(null==(e=n.textStyle)?void 0:e.fontSize)||18;t.setFontSize(i),t.setFillStyle((null==(a=n.textStyle)?void 0:a.color)||"#333"),t.setTextAlign("center"),t.setTextBaseline("top");const s=10;t.fillText(n.text,this.canvasWidth/2,s),r+=i+10}if(n.subtext){const e=(null==(i=n.subtextStyle)?void 0:i.fontSize)||14;t.setFontSize(e),t.setFillStyle((null==(s=n.subtextStyle)?void 0:s.color)||"#666"),t.setTextAlign("center"),t.setTextBaseline("top");const a=r+5;t.fillText(n.subtext,this.canvasWidth/2,a),r+=e+10}return r+=6,r},drawChartLegend(t,e,a=0){const i=this.options.legend||{};if(!1===i.show)return{height:0,width:0,left:0,right:0};try{const s=this.options.series||[],n=s.map(t=>Array.isArray(t)?{data:t}:t).map((t,e)=>t.name||`series${e}`),r={...i,data:n};console.log(i.left);const o={top:e,left:"center"===i.left?0:void 0!==i.left?i.left:(this.canvasWidth-this.canvasHeight+a)/2,right:"center"===i.left?0:void 0!==i.right?i.right:(this.canvasWidth-this.canvasHeight+a)/2,bottom:0};console.log(o);const h={...o},l=p.drawLegend(t,r,o,this.canvasWidth,p.defaultColors,this.canvasHeight,e);let d=0;return n.length>0&&(t.setFontSize(12),n.forEach(e=>{const a=t.measureText(e);d=Math.max(d,a.width)}),d+=30),{height:l,width:d,left:o.left!==h.left?o.left:0,right:o.right!==h.right?o.right:0}}catch(s){console.warn("Failed to use chartHelper.drawLegend, using fallback implementation",s)}},drawRadarGrid(t,e,a,i,s){const n=s.length,r=this.options.radar||{},o=r.splitNumber||5,h=r.shape||"polygon";t.setStrokeStyle("#E0E6F1"),t.setLineWidth(1);const l=r.splitArea||{},d=(l.areaStyle||{}).color||["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"];let c=0,p=i;if(void 0!==r.radius)if(Array.isArray(r.radius)){const t=r.radius[0],e=r.radius[1];"string"==typeof t&&t.endsWith("%")?c=parseInt(t)/100*i:"number"==typeof t&&(c=t),"string"==typeof e&&e.endsWith("%")?p=parseInt(e)/100*i:"number"==typeof e&&(p=e)}else"string"==typeof r.radius&&r.radius.endsWith("%")?p=parseInt(r.radius)/100*i:"number"==typeof r.radius&&(p=r.radius);if(l)for(let u=1;u<=o;u++){const i=c+(u-1)/o*(p-c),s=c+(p-c)*(u/o);if("circle"===h)t.beginPath(),t.arc(e,a,s,0,2*Math.PI),t.arc(e,a,i,0,2*Math.PI,!0),t.closePath();else{t.beginPath();for(let i=0;i<=n;i++){const r=2*i*Math.PI/n-Math.PI/2,o=e+s*Math.cos(r),h=a+s*Math.sin(r);0===i?t.moveTo(o,h):t.lineTo(o,h)}for(let s=n;s>=0;s--){const r=2*s*Math.PI/n-Math.PI/2,o=e+i*Math.cos(r),h=a+i*Math.sin(r);t.lineTo(o,h)}t.closePath()}const r=(u-1)%d.length;t.setFillStyle(d[r]),t.fill()}for(let u=1;u<=o;u++){const i=c+(p-c)*(u/o);if("circle"===h)t.beginPath(),t.arc(e,a,i,0,2*Math.PI),t.stroke();else{t.beginPath();for(let s=0;s<n;s++){const r=2*s*Math.PI/n-Math.PI/2,o=e+i*Math.cos(r),h=a+i*Math.sin(r);0===s?t.moveTo(o,h):t.lineTo(o,h)}t.closePath(),t.stroke()}}if("circle"!==h)for(let u=0;u<n;u++){const i=2*u*Math.PI/n-Math.PI/2,s=e+p*Math.cos(i),r=a+p*Math.sin(i);t.beginPath(),t.moveTo(e,a),t.lineTo(s,r),t.stroke()}},drawRadarData(t,e,a,i,s,n){var r;const o=s.length,h=this.options.color||["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],l=this.options.radar||{};let d=0,c=i;if(void 0!==l.radius)if(Array.isArray(l.radius)){const t=l.radius[0],e=l.radius[1];"string"==typeof t&&t.endsWith("%")?d=parseInt(t)/100*i:"number"==typeof t&&(d=t),"string"==typeof e&&e.endsWith("%")?c=parseInt(e)/100*i:"number"==typeof e&&(c=e)}else"string"==typeof l.radius&&l.radius.endsWith("%")?c=parseInt(l.radius)/100*i:"number"==typeof l.radius&&(c=l.radius);for(let p=0;p<n.length;p++){const i=n[p];let l;if(Array.isArray(i))l=i;else if(Array.isArray(i.data))l=i.data;else{if(!Array.isArray(i.value))continue;l=i.value}const u=i.color||(null==(r=i.itemStyle)?void 0:r.color)||h[p%h.length];if(!l||l.length!==o)continue;let g=[];for(let t=0;t<o;t++){const i=s[t].max||100,n=Array.isArray(l[t])?l[t][0]:l[t],r=d+Math.min((n||0)/i,1)*(c-d),h=2*t*Math.PI/o-Math.PI/2,p=e+r*Math.cos(h),u=a+r*Math.sin(h);g.push({x:p,y:u})}if(g.length>0&&void 0!==i.areaStyle){t.beginPath(),t.moveTo(g[0].x,g[0].y);for(let a=1;a<g.length;a++)t.lineTo(g[a].x,g[a].y);t.lineTo(g[0].x,g[0].y),t.closePath();let e=u;if(i.areaStyle&&i.areaStyle.color)e=i.areaStyle.color;else{e=((t,e=.5)=>{if(t.startsWith("rgba("))return t.replace(/,\s*[\d.]+\)$/,`, ${e})`);if(t.startsWith("rgb("))return t.replace("rgb(","rgba(").replace(")",`, ${e})`);if(t.startsWith("#")){let a=t.replace("#","");if(3===a.length&&(a=a.split("").map(t=>t+t).join("")),6===a.length){return`rgba(${parseInt(a.substring(0,2),16)}, ${parseInt(a.substring(2,4),16)}, ${parseInt(a.substring(4,6),16)}, ${e})`}}return`rgba(84, 112, 198, ${e})`})(u)}t.setFillStyle(e),t.fill()}if(g.length>0){t.beginPath(),t.moveTo(g[0].x,g[0].y);for(let e=1;e<g.length;e++)t.lineTo(g[e].x,g[e].y);t.lineTo(g[0].x,g[0].y),t.closePath(),t.setStrokeStyle(u),t.setLineWidth(2),t.stroke()}for(let e=0;e<g.length;e++)t.beginPath(),t.arc(g[e].x,g[e].y,4,0,2*Math.PI),t.setFillStyle("#ffffff"),t.setStrokeStyle(u),t.setLineWidth(2),t.fill(),t.stroke()}},drawRadarLabels(t,e,a,i,s){const n=s.length,r=this.options.radar||{};let o=i;if(void 0!==r.radius)if(Array.isArray(r.radius)){const t=r.radius[1];"string"==typeof t&&t.endsWith("%")?o=parseInt(t)/100*i:"number"==typeof t&&(o=t)}else"string"==typeof r.radius&&r.radius.endsWith("%")?o=parseInt(r.radius)/100*i:"number"==typeof r.radius&&(o=r.radius);t.setFontSize(12),t.setFillStyle("#666666"),t.setTextAlign("center"),t.setTextBaseline("middle");for(let h=0;h<n;h++){const i=s[h],r=2*h*Math.PI/n-Math.PI/2,l=o+14,d=e+l*Math.cos(r),c=a+l*Math.sin(r),p=(180*(r+Math.PI/2)/Math.PI+360)%360;p>330||p<30?(t.setTextAlign("left"),t.setTextBaseline("middle")):p>=30&&p<60?(t.setTextAlign("left"),t.setTextBaseline("top")):p>=60&&p<120?(t.setTextAlign("center"),t.setTextBaseline("top")):p>=120&&p<150?(t.setTextAlign("right"),t.setTextBaseline("top")):p>=150&&p<210?(t.setTextAlign("right"),t.setTextBaseline("middle")):p>=210&&p<240?(t.setTextAlign("right"),t.setTextBaseline("bottom")):p>=240&&p<300?(t.setTextAlign("center"),t.setTextBaseline("bottom")):p>=300&&p<=330&&(t.setTextAlign("left"),t.setTextBaseline("bottom")),t.fillText(i.name,d,c)}},tap(t){if(this.chartInstance&&"native-radar"===this.chartInstance.type){const{x:e,y:a}=t.touches[0];this.$emit("click",{x:e,y:a,event:t})}},move(t){},touchEnd(t){},updateData(t){this.chartInstance&&"native-radar"===this.chartInstance.type&&(Array.isArray(t)?Array.isArray(this.options.series[0])?this.options.series[0]=t:this.options.series[0].data=t:this.options.series=t,this.drawNativeRadar())},getChartInstance(){return this.chartInstance}}},[["render",function(t,h,l,d,c,p){const u=n,g=o;return a(),e(g,{class:"u-charts-radar"},{default:i(()=>[s(u,{id:c.cid,"canvas-id":c.cid,style:r({width:c.canvasWidth+"px",height:c.canvasHeight+"px"}),onTouchstart:p.tap,onTouchmove:p.move,onTouchend:p.touchEnd},null,8,["id","canvas-id","style","onTouchstart","onTouchmove","onTouchend"])]),_:1})}],["__scopeId","data-v-b7ace98c"]]);const g=t({data:()=>({basicChartOptions:{title:{text:"基础雷达图"},radar:{indicator:[{name:"攻击",max:100},{name:"防御",max:100},{name:"速度",max:100},{name:"力量",max:100},{name:"耐力",max:100},{name:"敏捷",max:100}],axisLine:{show:!0},name:{show:!0}},series:[{name:"角色能力",type:"radar",data:[82,93,89,95,75,80]}]},filledChartOptions:{title:{text:"填充雷达图"},legend:{data:["部门表现","预期表现"],left:"center"},radar:{indicator:[{name:"销售",max:100},{name:"管理",max:100},{name:"技术",max:100},{name:"市场",max:100},{name:"财务",max:100}],axisLine:{show:!0},name:{show:!0}},series:[{name:"部门表现",type:"radar",areaStyle:{color:"rgba(84, 112, 198, 0.5)"},data:[90,80,95,70,85]},{name:"预期表现",type:"radar",areaStyle:{},data:[50,60,65,30,46]}]},customGridOptions:{title:{text:"自定义网格背景色"},radar:{indicator:[{name:"销售",max:100},{name:"管理",max:100},{name:"技术",max:100},{name:"市场",max:100},{name:"财务",max:100}],splitArea:{areaStyle:{color:["rgba(255, 173, 177, 0.3)","rgba(179, 229, 252, 0.3)"]}},axisLine:{show:!0},name:{show:!0}},series:[{name:"部门表现",type:"radar",areaStyle:{color:"rgba(84, 112, 198, 0.6)"},data:[90,80,95,70,85]}]},circleChartOptions:{title:{text:"圆形雷达图"},radar:{indicator:[{name:"销售",max:100},{name:"管理",max:100},{name:"技术",max:100},{name:"市场",max:100},{name:"财务",max:100}],shape:"circle",splitNumber:4,splitArea:{areaStyle:{color:["rgba(250, 250, 250, 0.2)","rgba(210, 219, 238, 0.2)"]}},axisLine:{show:!0},name:{show:!0}},series:[{name:"部门表现",type:"radar",areaStyle:{color:"rgba(84, 112, 198, 0.3)"},data:[90,80,95,70,85]}]}}),methods:{handleChartClick(t){console.log("雷达图点击事件",t)}}},[["render",function(t,n,r,p,g,f){const m=d,y=h(l("ly-charts-radar"),u),x=o;return a(),e(x,{class:"u-page"},{default:i(()=>[s(x,{class:"u-page__item"},{default:i(()=>[s(m,{class:"u-page__item__title",style:{"margin-top":"0"}},{default:i(()=>[c("基础雷达图")]),_:1}),s(x,{class:"u-page__item__content"},{default:i(()=>[s(y,{width:"720rpx",height:"210px",options:g.basicChartOptions,onClick:f.handleChartClick},null,8,["options","onClick"])]),_:1})]),_:1}),s(x,{class:"u-page__item"},{default:i(()=>[s(m,{class:"u-page__item__title",style:{"margin-top":"0"}},{default:i(()=>[c("填充雷达图")]),_:1}),s(x,{class:"u-page__item__content"},{default:i(()=>[s(y,{width:"720rpx",height:"250px",options:g.filledChartOptions,onClick:f.handleChartClick},null,8,["options","onClick"])]),_:1})]),_:1}),s(x,{class:"u-page__item"},{default:i(()=>[s(m,{class:"u-page__item__title",style:{"margin-top":"0"}},{default:i(()=>[c("自定义网格背景色")]),_:1}),s(x,{class:"u-page__item__content"},{default:i(()=>[s(y,{width:"720rpx",height:"230px",options:g.customGridOptions,onClick:f.handleChartClick},null,8,["options","onClick"])]),_:1})]),_:1}),s(x,{class:"u-page__item"},{default:i(()=>[s(m,{class:"u-page__item__title",style:{"margin-top":"0"}},{default:i(()=>[c("圆形雷达图")]),_:1}),s(x,{class:"u-page__item__content"},{default:i(()=>[s(y,{width:"720rpx",height:"230px",options:g.circleChartOptions,onClick:f.handleChartClick},null,8,["options","onClick"])]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-0aeef1f9"]]);export{g as default};
